<!DOCTYPE html>
{% load i18n %}
{% load static %}
<html lang="{{ LANGUAGE_CODE }}">  <!-- YANGI: Til kodini dinamik qilish uchun o'zgartirildi, SEO uchun muhim -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="5doQhgVdemuA8B1Os5P49BxQBWlqJofh5t326JDmQps">

    <!-- SEO Meta Description - Optimized for search engines -->
    <meta name="description" content="{% block meta_description %}{% trans "Avtokontinent.uz (Автоконтинент.уз) - O'zbekistondagi eng yaxshi avtomobil ehtiyot qismlari do'koni. Barcha brendlar uchun original qismlar: vakum nasos, babina, tormoz qismlari. Toshkent, Samarqand, Buxoro bo'ylab tezkor yetkazib berish. Лучший магазин автозапчастей в Узбекистане. Оригинальные запчасти для всех марок: вакуумный насос, катушка, тормозные детали. Быстрая доставка по Ташкенту, Самарканду, Бухаре." %}{% endblock %}">

    <!-- SEO Keywords -->
    <meta name="keywords" content="{% block meta_keywords %}avtokontinent, автоконтинент, avtokontinent.uz, автоконтинент.уз, avtomobil qismlar, auto parts, ehtiyot qismlar, vakum nasos, babina, tormoz qismlari, O'zbekiston, Toshkent, автозапчасти, вакуумный насос, катушка, тормозные детали, Узбекистан, Ташкент, avto kontinent, авто континент{% endblock %}">

    <!-- Author and Publisher -->
    <meta name="author" content="Avtokontinent.uz">
    <meta name="publisher" content="Avtokontinent.uz">

    <!-- Geographic targeting -->
    <meta name="geo.region" content="UZ">
    <meta name="geo.placename" content="Uzbekistan">
    <meta name="geo.position" content="41.377491;64.585262">
    <meta name="ICBM" content="41.377491, 64.585262">

    <!-- Additional SEO meta tags for brand recognition -->
    <meta name="application-name" content="Avtokontinent">
    <meta name="msapplication-TileColor" content="#2563EB">
    <meta name="theme-color" content="#2563EB">
    
    <!-- Brand-specific meta tags -->
    <meta name="brand" content="avtokontinent">
    <meta name="brand-alt" content="автоконтинент">
    <meta name="company" content="Avtokontinent.uz">
    
    <!-- Search engine specific tags -->
    <meta name="googlebot" content="index,follow">
    <meta name="bingbot" content="index,follow">
    <meta name="yandex" content="index,follow">
    
    <!-- Language and locale meta tags -->
    <meta name="language" content="{% if LANGUAGE_CODE == 'uz' %}Uzbek{% elif LANGUAGE_CODE == 'cyrl' %}Uzbek-Cyrillic{% else %}Russian{% endif %}">
    <meta name="content-language" content="{{ LANGUAGE_CODE }}">

    <!-- YANGI: Robots meta - indekslashni ruxsat berish -->
    <meta name="robots" content="index, follow">

    <!-- YANGI: Canonical link - duplikat sahifalarni oldini olish -->
    <link rel="canonical" href="https://avtokontinent.uz{{ request.path }}">

    <!-- YANGI: Hreflang taglari - ko'p tillik uchun (hozirgi tizimda cheklangan, URL prefix qo'shing) -->
    {% get_available_languages as LANGUAGES %}
    {% get_current_language as CURRENT_LANG %}
    <link rel="alternate" hreflang="x-default" href="https://avtokontinent.uz{{ request.path }}" />  <!-- Default (masalan, uz) -->
    {% for lang in LANGUAGES %}
        <link rel="alternate" hreflang="{% if lang.0 == 'uz' %}uz-Latn{% elif lang.0 == 'cyrl' %}uz-Cyrl{% else %}ru{% endif %}" href="https://avtokontinent.uz{{ request.path }}?lang={{ lang.0 }}" />  <!-- ?lang qo'shdim, lekin post emas get qiling (views da qo'llab-quvvatlang) -->
    {% endfor %}
    <!-- Self-referencing -->
    <link rel="alternate" hreflang="{% if CURRENT_LANG == 'uz' %}uz-Latn{% elif CURRENT_LANG == 'cyrl' %}uz-Cyrl{% else %}ru{% endif %}" href="https://avtokontinent.uz{{ request.path }}" />

    <!-- Open Graph meta tags for social media sharing -->
    <meta property="og:title" content="{% block og_title %}{% trans "Avtokontinent.uz - O'zbekistondagi eng yaxshi avtomobil ehtiyot qismlari do'koni" %}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{% trans "Barcha brendlar uchun original avtomobil qismlari. Vakum nasos, babina, tormoz qismlari. Tezkor yetkazib berish O'zbekiston bo'ylab. Оригинальные автозапчасти для всех марок. Вакуумный насос, катушка, тормозные детали. Быстрая доставка по Узбекистану." %}{% endblock %}">
    <meta property="og:image" content="https://avtokontinent.uz{% static 'images/og-image.jpg' %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="{% trans 'Avtokontinent.uz - Avtomobil ehtiyot qismlari' %}">
    <meta property="og:url" content="https://avtokontinent.uz{{ request.path }}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:site_name" content="Avtokontinent.uz">
    <meta property="og:locale" content="{% if LANGUAGE_CODE == 'uz' %}uz_UZ{% elif LANGUAGE_CODE == 'cyrl' %}uz_UZ{% else %}ru_RU{% endif %}">
    {% get_available_languages as LANGUAGES %}
    {% for lang in LANGUAGES %}
        {% if lang.0 != LANGUAGE_CODE %}
    <meta property="og:locale:alternate" content="{% if lang.0 == 'uz' %}uz_UZ{% elif lang.0 == 'cyrl' %}uz_UZ{% else %}ru_RU{% endif %}">
        {% endif %}
    {% endfor %}

    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@avtokontinent">
    <meta name="twitter:creator" content="@avtokontinent">
    <meta name="twitter:title" content="{% block twitter_title %}{% trans "Avtokontinent.uz - Avtomobil ehtiyot qismlari" %}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{% trans "Original avtomobil qismlari barcha brendlar uchun. Tezkor yetkazib berish O'zbekiston bo'ylab." %}{% endblock %}">
    <meta name="twitter:image" content="https://avtokontinent.uz{% static 'images/og-image.jpg' %}">
    <meta name="twitter:image:alt" content="{% trans 'Avtokontinent.uz logo' %}">

    <title>{% block title %}{% trans "Avtokontinent.uz (Автоконтинент.уз) - Auto Spare Parts | Avtomobil Ehtiyot Qismlari" %}{% endblock %}</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        {% load static %}
        :root {
            --primary-color: #2563EB;
            --secondary-color: #EA580C;
            --accent-color: #16A34A;
            --success-color: #10B981;
            --warning-color: #F59E0B;
            --error-color: #EF4444;
            --red-color: #DC2626;
            --blue-color: #2563EB;
            --neutral-100: #F3F4F6;
            --neutral-200: #E5E7EB;
            --neutral-300: #D1D5DB;
            --neutral-400: #9CA3AF;
            --neutral-500: #6B7280;
            --neutral-600: #4B5563;
            --neutral-700: #374151;
            --neutral-800: #1F2937;
            --neutral-900: #111827;
            --white: #FFFFFF;
            --navbar-height: 70px;
            --navbar-mobile-height: 120px;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--neutral-700);
            background:
                linear-gradient(135deg, rgba(17, 24, 39, 0.85) 0%, rgba(31, 41, 55, 0.8) 100%),
                url('https://images.pexels.com/photos/3806288/pexels-photo-3806288.jpeg?auto=compress&cs=tinysrgb&w=1920&h=1080&fit=crop');
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 100vh;
            padding-top: var(--navbar-height);
            padding-bottom: 70px; /* Pastki nav uchun joy */
        }

        /* Mobile padding adjustment */
        @media (max-width: 768px) {
            body {
                padding-top: var(--navbar-mobile-height);
            }
        }

        /* Fixed Top Navigation */
        .top-navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1050;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--neutral-200);
            height: var(--navbar-height);
            transition: all 0.3s ease;
        }

        /* Mobile navbar height adjustment */
        @media (max-width: 768px) {
            .top-navbar {
                height: var(--navbar-mobile-height);
            }
        }

        .top-navbar.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .top-navbar .navbar-brand {
            font-size: 1.8rem;
            font-weight: 900;
            text-decoration: none;
            display: flex;
            align-items: center;
            letter-spacing: 1px;
        }

        .brand-avto {
            color: var(--red-color) !important;
        }

        .brand-kontinent {
            color: var(--blue-color) !important;
        }

        .top-navbar .navbar-nav {
            align-items: center;
            gap: 1rem;
        }
        .top-navbar .nav-link {
            color: var(--neutral-700) !important;
            font-weight: 500;
            padding: 0.5rem 1rem !important;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .top-navbar .nav-link:hover {
            background: var(--neutral-100);
            color: var(--primary-color) !important;
        }
        .nav-icon-wrapper {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--neutral-100);
            transition: all 0.3s ease;
        }
        .nav-icon-wrapper:hover {
            background: var(--primary-color);
            color: var(--white);
            transform: translateY(-2px);
        }
        .nav-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error-color);
            color: var(--white);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--white);
        }

        .search-form {
            position: relative;
            max-width: 400px;
            width: 100%;
        }

        /* Desktop search form */
        @media (min-width: 769px) {
            .search-form {
                max-width: 400px;
            }
        }

        /* Mobile layout improvements */
        @media (max-width: 768px) {
            .mobile-navbar-content {
                width: 100%;
                display: flex;
                flex-direction: column;
                padding: 0;
            }

            .mobile-top-row {
                display: flex;
                justify-content: flex-start;
                align-items: center;
                padding: 10px 15px;
                height: 60px;
                width: 100%;
            }

            .navbar-brand {
                font-size: 1.5rem !important;
                font-weight: 900;
                margin: 0;
                padding: 0;
            }

            /* Mobile Search Form - hidden by default */
            .mobile-search {
                display: none;
                width: 100%;
                padding: 0 15px 10px 15px;
                background: rgba(255, 255, 255, 0.95);
                border-top: 1px solid var(--neutral-200);
            }

            .mobile-search.show {
                display: block;
            }

            .mobile-search-wrapper {
                width: 100%;
                display: flex;
                justify-content: center;
            }

            .mobile-search-wrapper .search-form {
                width: 100%;
                max-width: none;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
                border-radius: 25px;
                overflow: hidden;
            }

            .mobile-search-wrapper .search-form input {
                border-radius: 25px;
                padding: 12px 45px 12px 20px;
                font-size: 14px;
                border: 2px solid var(--neutral-200);
                background: var(--white);
                transition: all 0.3s ease;
                width: 100%;
                height: 45px;
            }

            .mobile-search-wrapper .search-form input:focus {
                border-color: var(--primary-color);
                box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
                outline: none;
            }

            .mobile-search-wrapper .search-form button {
                position: absolute;
                right: 5px;
                top: 50%;
                transform: translateY(-50%);
                width: 35px;
                height: 35px;
                border-radius: 50%;
                background: var(--primary-color);
                border: none;
                color: white;
                transition: all 0.3s ease;
            }

            .mobile-search-wrapper .search-form button:hover {
                background: #1E40AF;
                transform: translateY(-50%) scale(1.05);
            }

            /* Search toggle button */
            .search-toggle {
                position: fixed;
                top: 15px;
                right: 15px;
                z-index: 1051;
                background: var(--primary-color);
                color: white;
                border: none;
                border-radius: 50%;
                width: 45px;
                height: 45px;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
                transition: all 0.3s ease;
            }

            .search-toggle:hover {
                background: #1E40AF;
                transform: scale(1.1);
            }

            .search-toggle.active {
                background: var(--error-color);
            }

            .desktop-search {
                display: none;
            }

            .top-navbar .navbar-nav.ms-auto {
                display: none;
            }
        }

        @media (min-width: 769px) {
            .mobile-navbar-content {
                display: contents;
            }

            .mobile-top-row {
                display: contents;
            }

            .desktop-search {
                display: block;
            }

            .mobile-search {
                display: none !important;
            }

            .search-toggle {
                display: none;
            }
        }

        .search-form input {
            padding: 0.75rem 3rem 0.75rem 1rem;
            border: 1px solid var(--neutral-300);
            border-radius: 2rem;
            background: var(--white);
            transition: all 0.3s ease;
            width: 100%;
        }
        .search-form input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        .search-form button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary-color);
            border: none;
            color: var(--white);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .search-form button:hover {
            background: #1E40AF;
            transform: translateY(-50%) scale(1.05);
        }

        /* Main Content Sections */
        .main-content {
            background: var(--white);
            border-radius: 1rem 1rem 0 0;
            margin-top: 2rem;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .section {
            padding: 3rem 0;
        }
        .section:nth-child(even) {
            background: var(--neutral-50);
        }
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--neutral-800);
            margin-bottom: 1rem;
            position: relative;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 2px;
        }
        .section-subtitle {
            font-size: 1.125rem;
            color: var(--neutral-600);
            max-width: 600px;
            margin: 0 auto;
        }
        .view-more-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .view-more-btn:hover {
            color: #1E40AF;
            transform: translateX(5px);
        }
        /* Brand Cards */
        .brand-card {
            background: var(--white);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid var(--neutral-200);
            height: 100%;
        }
        .brand-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }
        .brand-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
        }
        .brand-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--neutral-800);
            margin-bottom: 0.5rem;
        }
        .brand-count {
            font-size: 0.875rem;
            color: var(--neutral-500);
        }
        /* Category Cards */
        .category-card {
            background: linear-gradient(135deg, var(--white) 0%, var(--neutral-50) 100%);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid var(--neutral-200);
            height: 100%;
            position: relative;
            overflow: hidden;
        }
        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .category-card:hover::before {
            transform: scaleX(1);
        }
        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        .category-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), #1E40AF);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: var(--white);
            font-size: 1.5rem;
        }
        .category-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--neutral-800);
            margin-bottom: 0.5rem;
        }
        .category-description {
            font-size: 0.875rem;
            color: var(--neutral-600);
            line-height: 1.5;
        }
        /* Product Cards */
        .btn-primary {
            background: var(--primary-color);
            border: none;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: #1E40AF;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }
        .btn-secondary {
            background: var(--secondary-color);
            border: none;
            color: var(--white);
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background: #C2410C;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(234, 88, 12, 0.3);
        }
        .card {
            border: none;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            overflow: hidden;
            background: var(--white);
        }
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        .product-card {
            position: relative;
            height: 100%;
        }
        .product-card .card-img-top {
            height: 220px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        .product-card:hover .card-img-top {
            transform: scale(1.05);
        }
        .product-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .product-card:hover .product-actions {
            opacity: 1;
        }
        .btn-action {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--white);
            color: var(--neutral-600);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        .btn-action:hover {
            background: var(--primary-color);
            color: var(--white);
            transform: scale(1.15);
        }
        .btn-action.liked {
            background: var(--error-color);
            color: var(--white);
        }
        .btn-action.favorited {
            background: var(--warning-color);
            color: var(--white);
        }
        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--primary-color);
            color: var(--white);
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .product-badge.bestseller {
            background: var(--success-color);
        }
        .product-badge.most-liked {
            background: var(--error-color);
        }
        .product-stats {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            color: var(--neutral-500);
        }
        .product-stat {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        .price-old {
            font-size: 1rem;
            color: var(--neutral-500);
            text-decoration: line-through;
            margin-right: 0.5rem;
        }
        /* Bottom Navigation Styling */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--white);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            height: 60px;
            z-index: 1050;
            display: none;
        }
        .bottom-nav .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 5px;
            min-width: 80px;
            color: var(--neutral-600);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .bottom-nav .nav-item i {
            font-size: 1.2rem;
        }
        .bottom-nav .nav-item span {
            font-size: 0.75rem;
            margin-top: 2px;
        }
        .bottom-nav .nav-item.active,
        .bottom-nav .nav-item:hover {
            color: var(--primary-color);
        }
        .bottom-nav .nav-badge {
            top: -2px;
            right: 30%;
            font-size: 0.65rem;
            width: 16px;
            height: 16px;
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            .top-navbar {
                display: flex;
            }
            .bottom-nav {
                display: flex;
            }
            body {
                padding-top: var(--navbar-mobile-height);
                padding-bottom: 70px;
            }
            .product-list {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
                padding: 0 1rem;
            }
            .product-card {
                width: 100%;
            }
        }
        @media (min-width: 769px) {
            .bottom-nav {
                display: none;
            }
        }
        @media (max-width: 576px) {
            .bottom-nav .nav-item {
                min-width: 70px;
                font-size: 0.7rem;
            }
        }
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(37, 99, 235, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .footer {
            background: var(--neutral-800);
            color: var(--white);
            padding: 3rem 0 1rem;
            margin-top: 0;
        }
        .footer h5 {
            color: var(--white);
            margin-bottom: 1rem;
            font-weight: 600;
        }
        .footer a {
            color: var(--neutral-300);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        .footer a:hover {
            color: var(--white);
        }
        .social-links a {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: var(--white);
            text-align: center;
            line-height: 40px;
            border-radius: 50%;
            margin-right: 0.5rem;
            transition: all 0.3s ease;
        }
        .social-links a:hover {
            background: var(--secondary-color);
            transform: translateY(-3px);
        }
    </style>
    {% block extra_css %}{% endblock %}

    <!-- Schema.org structured data (JSON-LD) for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": ["WebSite", "Store"],
      "name": "Avtokontinent.uz",
      "alternateName": ["Автоконтинент.уз", "Avto Kontinent", "avtokontinent", "автоконтинент", "Avtokontinent", "Автоконтинент"],
      "url": "https://avtokontinent.uz",
      "description": "{% trans 'O\'zbekistondagi eng yaxshi avtomobil ehtiyot qismlari do\'koni. Barcha brendlar uchun original qismlar. Лучший магазин автозапчастей в Узбекистане. Оригинальные запчасти для всех марок.' %}",
      "logo": "https://avtokontinent.uz{% static 'images/logo.png' %}",
      "image": "https://avtokontinent.uz{% static 'images/og-image.jpg' %}",
      "telephone": "+998950592112",
      "email": "info@avtokontinent.uz",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Zarafshon shahri",
        "addressLocality": "Zarafshon",
        "addressRegion": "Navoiy viloyati",
        "addressCountry": "UZ",
        "postalCode": "210100"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": "41.377491",
        "longitude": "64.585262"
      },
      "openingHours": "Mo-Sa 09:00-18:00",
      "currenciesAccepted": "UZS",
      "paymentAccepted": ["Cash", "CreditCard", "BankTransfer"],
      "priceRange": "$$",
      "areaServed": {
        "@type": "Country",
        "name": "Uzbekistan"
      },
      "serviceArea": {
        "@type": "GeoCircle",
        "geoMidpoint": {
          "@type": "GeoCoordinates",
          "latitude": "41.377491",
          "longitude": "64.585262"
        },
        "geoRadius": "1000000"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://avtokontinent.uz{% url 'product_list' %}?search={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      },
      "sameAs": [
        "https://t.me/avtokontinent",
        "https://instagram.com/avtokontinent",
        "https://facebook.com/avtokontinent"
      ],
      "keywords": "avtokontinent, автоконтинент, avtomobil qismlar, автозапчасти, O'zbekiston, Узбекистан",
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "{% trans 'Avtomobil ehtiyot qismlari' %}",
        "itemListElement": [
          {
            "@type": "OfferCatalog",
            "name": "{% trans 'Vakum nasos' %}",
            "description": "{% trans 'Barcha avtomobil markalari uchun vakum nasoslari' %}"
          },
          {
            "@type": "OfferCatalog", 
            "name": "{% trans 'Babina' %}",
            "description": "{% trans 'Yuqori sifatli babinalar va elektr qismlari' %}"
          },
          {
            "@type": "OfferCatalog",
            "name": "{% trans 'Tormoz qismlari' %}",
            "description": "{% trans 'Xavfsizlik uchun original tormoz qismlari' %}"
          }
        ]
      }
    }
    </script>

    {% block extra_schema %}{% endblock %}
    
    <!-- Include additional SEO meta tags -->
    {% include 'seo_meta.html' %}
</head>
<body>
    <!-- Fixed Top Navigation -->
    <nav class="top-navbar navbar navbar-expand-lg" id="topNavbar">
        <div class="container">
            <div class="mobile-navbar-content">
                <div class="mobile-top-row">
                    <!-- Brand name - left aligned on mobile -->
                    <a class="navbar-brand" href="{% url 'home' %}">
                        <span class="brand-avto">AVTO</span><span class="brand-kontinent">KONTINENT</span>
                    </a>
                </div>

                <!-- Mobile Search Form - hidden by default -->
                <div class="mobile-search d-md-none">
                    <div class="mobile-search-wrapper">
                        <form class="search-form" method="get" action="{% url 'product_list' %}">
                            <input type="text" name="search" class="form-control" placeholder="{% trans 'Search products...' %}" value="{{ request.GET.search }}">
                            <button type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <button class="navbar-toggler d-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse d-none" id="navbarNav">
                <!-- Desktop Search Form -->
                <form class="search-form mx-auto desktop-search" method="get" action="{% url 'product_list' %}">
                    <input type="text" name="search" class="form-control" placeholder="{% trans 'Search products...' %}" value="{{ request.GET.search }}">
                    <button type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
            </div>

            <!-- Desktop Navigation Icons -->
            <ul class="navbar-nav ms-auto d-none d-md-flex">
                <!-- Language Switcher -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-globe"></i>
                        <span class="d-none d-md-inline ms-1">
                            {% get_current_language as LANGUAGE_CODE %}
                            {% if LANGUAGE_CODE == 'uz' %}Oʻzbekcha{% elif LANGUAGE_CODE == 'cyrl' %}O'zbek(Krill){% else %}Русский{% endif %}
                        </span>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                        {% get_available_languages as LANGUAGES %}
                        {% get_current_language as LANGUAGE_CODE %}
                        {% for lang in LANGUAGES %}
                            <li>
                                <form action="{% url 'set_language' %}" method="post" class="d-inline">
                                    {% csrf_token %}
                                    <input name="next" type="hidden" value="{{ request.get_full_path }}">
                                    <input name="language" type="hidden" value="{{ lang.0 }}">
                                    <button type="submit" class="dropdown-item {% if LANGUAGE_CODE == lang.0 %}active{% endif %}">
                                        {{ lang.1 }}
                                    </button>
                                </form>
                            </li>
                        {% endfor %}
                    </ul>
                </li>
                <!-- FAVORITES -->
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'favorites' %}" data-bs-toggle="tooltip" title="{% trans 'Favorites' %}">
                        <div class="nav-icon-wrapper">
                            <i class="fas fa-star"></i>
                            {% if favorites_count %}
                                <span class="nav-badge" id="favorites-badge">{{ favorites_count }}</span>
                            {% endif %}
                        </div>
                    </a>
                </li>
                <!-- CART -->
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'cart' %}" data-bs-toggle="tooltip" title="{% trans 'Shopping Cart' %}">
                        <div class="nav-icon-wrapper">
                            <i class="fas fa-shopping-cart"></i>
                            {% if cart_items_count %}
                                <span class="nav-badge" id="cart-badge">{{ cart_items_count }}</span>
                            {% endif %}
                        </div>
                    </a>
                </li>
                <!-- ACCOUNT -->
                {% if user.is_authenticated %}
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-bs-toggle="tooltip" title="{% trans 'My Account' %}">
                            <div class="nav-icon-wrapper">
                                <i class="fas fa-user"></i>
                            </div>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            <li><a class="dropdown-item" href="{% url 'order_history' %}"><i class="fas fa-history"></i> {% trans 'Order History' %}</a></li>
                            <li>
                                <form action="{% url 'logout' %}" method="post" class="m-0 p-0">
                                    {% csrf_token %}
                                    <button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt"></i> {% trans 'Logout' %}</button>
                                </form>
                            </li>
                        </ul>
                    </li>
                {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'login' %}" data-bs-toggle="tooltip" title="{% trans 'Login' %}">
                            <div class="nav-icon-wrapper">
                                <i class="fas fa-sign-in-alt"></i>
                            </div>
                        </a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <!-- Mobile Search Toggle Button -->
    <button class="search-toggle d-md-none" id="searchToggle">
        <i class="fas fa-search" id="searchIcon"></i>
    </button>

    <!-- Messages -->
    {% if messages %}
        <div class="container" style="margin-top: 1rem;">
            {% for message in messages %}
                {% if 'error' in message.tags %}
                    <div class="alert alert-danger text-danger alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% else %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}

    <!-- Main Content -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <!-- Bottom Navigation (Mobile) - 5 ta tugma -->
    <nav class="bottom-nav d-block d-md-none">
        <div class="container-fluid p-0">
            <div class="d-flex justify-content-around align-items-center" style="height: 60px;">
                <!-- Home -->
                <a href="{% url 'home' %}" class="nav-item text-center" data-bs-toggle="tooltip" title="{% trans 'Home' %}">
                    <i class="fas fa-home"></i>
                    <span>{% trans "Home" %}</span>
                </a>

                <!-- Cart -->
                <a href="{% url 'cart' %}" class="nav-item text-center" data-bs-toggle="tooltip" title="{% trans 'Cart' %}">
                    <div style="position: relative;">
                        <i class="fas fa-shopping-cart"></i>
                        {% if cart_items_count %}
                            <span class="nav-badge" id="cart-badge-mobile">{{ cart_items_count }}</span>
                        {% endif %}
                    </div>
                    <span>{% trans "Cart" %}</span>
                </a>

                <!-- Favorites -->
                <a href="{% url 'favorites' %}" class="nav-item text-center" data-bs-toggle="tooltip" title="{% trans 'Favorites' %}">
                    <div style="position: relative;">
                        <i class="fas fa-star"></i>
                        {% if favorites_count %}
                            <span class="nav-badge" id="favorites-badge-mobile">{{ favorites_count }}</span>
                        {% endif %}
                    </div>
                    <span>{% trans "Favorites" %}</span>
                </a>

                <!-- Language -->
                <a href="#" class="nav-item text-center dropdown" data-bs-toggle="dropdown" aria-expanded="false" data-bs-toggle="tooltip" title="{% trans 'Language' %}">
                    <i class="fas fa-globe"></i>
                    <span>
                        {% get_current_language as LANGUAGE_CODE %}
                        {% if LANGUAGE_CODE == 'uz' %}Oʻz{% elif LANGUAGE_CODE == 'cyrl' %}Kr{% else %}Ru{% endif %}
                    </span>
                </a>
                <ul class="dropdown-menu dropdown-menu-center" aria-labelledby="languageDropdownMobile">
                    {% get_available_languages as LANGUAGES %}
                    {% get_current_language as LANGUAGE_CODE %}
                    {% for lang in LANGUAGES %}
                        <li>
                            <form action="{% url 'set_language' %}" method="post" class="d-inline">
                                {% csrf_token %}
                                <input name="next" type="hidden" value="{{ request.get_full_path }}">
                                <input name="language" type="hidden" value="{{ lang.0 }}">
                                <button type="submit" class="dropdown-item {% if LANGUAGE_CODE == lang.0 %}active{% endif %}">
                                    {{ lang.1 }}
                                </button>
                            </form>
                        </li>
                    {% endfor %}
                </ul>

                <!-- Account/Login -->
                {% if user.is_authenticated %}
                    <a href="#" class="nav-item text-center dropdown" id="userDropdownMobile" data-bs-toggle="dropdown" aria-expanded="false" data-bs-toggle="tooltip" title="{% trans 'Account' %}">
                        <i class="fas fa-user"></i>
                        <span>{% trans "Account" %}</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-center" aria-labelledby="userDropdownMobile">
                        <li><a class="dropdown-item" href="{% url 'order_history' %}"><i class="fas fa-history"></i> {% trans 'Order History' %}</a></li>
                        <li>
                            <form action="{% url 'logout' %}" method="post" class="m-0 p-0">
                                {% csrf_token %}
                                <button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt"></i> {% trans 'Logout' %}</button>
                            </form>
                        </li>
                    </ul>
                {% else %}
                    <a href="{% url 'login' %}" class="nav-item text-center" data-bs-toggle="tooltip" title="{% trans 'Login' %}">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>{% trans "Login" %}</span>
                    </a>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Footer -->
<footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>{% trans "Avtokontinent.uz" %}</h5>
                    <p>{% trans "Your trusted partner for quality auto spare parts. We provide genuine parts for all car brands with fast delivery across Uzbekistan." %}</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-telegram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="col-md-2">
                    <h5>{% trans "Quick Links" %}</h5>
                    <ul class="list-unstyled">
                        <li><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
                        <li><a href="{% url 'product_list' %}">{% trans "Products" %}</a></li>
<!--                        <li><a href="{% url 'brands' %}">{% trans "Brands" %}</a></li>-->
                        <li><a href="#">{% trans "About Us" %}</a></li>
                    </ul>
                </div>
                <div class="col-md-2">
                    <h5>{% trans "Categories" %}</h5>
                    <ul class="list-unstyled">
                        {% for category in categories|slice:":4" %}
                        <li><a href="{% url 'product_list' %}?category={{ category.slug }}">{{ category.name }}</a></li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>{% trans "Contact Info" %}</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-map-marker-alt"></i> {% trans "O'zbekiston, Navoiy viloyati, Zarafshon shahri" %}</li>
                        <li><i class="fas fa-phone"></i> +998 95 059 21 12</li>
                        <li><i class="fas fa-envelope"></i> info@avtokontinent.uz</li>
                        <li><i class="fas fa-warehouse"></i> {% trans "Omborlar: Toshkent, Qo'qon" %}</li>
                        <li><i class="fas fa-clock"></i> {% trans "Mon-Sat: 9:00 AM - 6:00 PM" %}</li>
                    </ul>
                </div>
            </div>
            <hr class="my-4">
            <div class="row">
                <div class="col-md-6">
                    <p>&copy; 2025 {% trans "Avtokontinent.uz. All rights reserved." %}</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="#" class="me-3">{% trans "Privacy Policy" %}</a>
                    <a href="#" class="me-3">{% trans "Terms of Service" %}</a>
                    <a href="#">{% trans "Support" %}</a>
                </div>
            </div>
        </div>
    </footer>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Custom JS -->
    <script>
        // Mobile search toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const searchToggle = document.getElementById('searchToggle');
            const mobileSearch = document.querySelector('.mobile-search');
            const searchIcon = document.getElementById('searchIcon');
            let isSearchVisible = false;

            if (searchToggle && mobileSearch) {
                searchToggle.addEventListener('click', function() {
                    isSearchVisible = !isSearchVisible;

                    if (isSearchVisible) {
                        mobileSearch.classList.add('show');
                        searchIcon.className = 'fas fa-times';
                        searchToggle.classList.add('active');
                        // Focus on search input
                        setTimeout(() => {
                            const searchInput = mobileSearch.querySelector('input');
                            if (searchInput) searchInput.focus();
                        }, 100);
                    } else {
                        mobileSearch.classList.remove('show');
                        searchIcon.className = 'fas fa-search';
                        searchToggle.classList.remove('active');
                    }
                });

                // Close search when clicking outside
                document.addEventListener('click', function(event) {
                    if (!searchToggle.contains(event.target) && !mobileSearch.contains(event.target)) {
                        if (isSearchVisible) {
                            mobileSearch.classList.remove('show');
                            searchIcon.className = 'fas fa-search';
                            searchToggle.classList.remove('active');
                            isSearchVisible = false;
                        }
                    }
                });
            }
        });

        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('topNavbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        // CSRF token
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        const csrftoken = getCookie('csrftoken');

        // Update cart and favorites count
        function updateCartCount(count) {
            const cartBadge = $('#cart-badge, #cart-badge-mobile, #cart-badge-mobile-top');
            if (count > 0) {
                cartBadge.text(count).show();
            } else {
                cartBadge.hide();
            }
        }

        function updateFavoritesCount(count) {
            const favoritesBadge = $('#favorites-badge, #favorites-badge-mobile, #favorites-badge-mobile-top');
            if (count > 0) {
                favoritesBadge.text(count).show();
            } else {
                favoritesBadge.hide();
            }
        }

        // Like, Favorite, Cart functions
        function likeProduct(productId) {
            $.ajax({
                url: '{% url "ajax_like_product" %}',
                type: 'POST',
                data: {'product_id': productId, 'csrfmiddlewaretoken': csrftoken},
                success: function(response) {
                    if (response.success) {
                        const likeBtn = $(`#like-btn-${productId}`);
                        const likeCount = $(`#like-count-${productId}`);
                        if (response.liked) {
                            likeBtn.addClass('liked').html('<i class="fas fa-heart"></i>');
                        } else {
                            likeBtn.removeClass('liked').html('<i class="far fa-heart"></i>');
                        }
                        likeCount.text(response.like_count);
                    } else {
                        alert(response.message);
                    }
                }
            });
        }

        function favoriteProduct(productId) {
            $.ajax({
                url: '{% url "ajax_favorite_product" %}',
                type: 'POST',
                data: {'product_id': productId, 'csrfmiddlewaretoken': csrftoken},
                success: function(response) {
                    if (response.success) {
                        const btn = $(`#favorite-btn-${productId}`);
                        if (response.favorited) {
                            btn.addClass('favorited').html('<i class="fas fa-star"></i>');
                        } else {
                            btn.removeClass('favorited').html('<i class="far fa-star"></i>');
                        }
                        updateFavoritesCount(response.favorites_count);
                        showToast(response.favorited ? 'Added to favorites!' : 'Removed from favorites!', 'success');

                        // Store favorites data in localStorage for guest users
                        {% if not user.is_authenticated %}
                        const localFavorites = JSON.parse(localStorage.getItem('local_favorites') || '[]');
                        if (response.favorited) {
                            if (!localFavorites.includes(productId)) {
                                localFavorites.push(productId);
                            }
                        } else {
                            const index = localFavorites.indexOf(productId);
                            if (index > -1) {
                                localFavorites.splice(index, 1);
                            }
                        }
                        localStorage.setItem('local_favorites', JSON.stringify(localFavorites));
                        {% endif %}
                    } else {
                        showToast(response.message, 'error');
                    }
                },
                error: function() {
                    showToast('Error occurred. Please try again.', 'error');
                }
            });
        }

        function addToCart(productId, quantity = 1) {
            $.ajax({
                url: '{% url "ajax_add_to_cart" %}',
                type: 'POST',
                data: {'product_id': productId, 'quantity': quantity, 'csrfmiddlewaretoken': csrftoken},
                beforeSend: function() {
                    $(`.add-to-cart-${productId}`).prop('disabled', true).html('<i class="fas fa-spinner fa-spin"></i>');
                },
                success: function(response) {
                    if (response.success) {
                        updateCartCount(response.cart_total);
                        showToast(response.message, 'success');

                        // Store cart data in localStorage for guest users
                        {% if not user.is_authenticated %}
                        const localCart = JSON.parse(localStorage.getItem('local_cart') || '{}');
                        localCart[productId] = (localCart[productId] || 0) + quantity;
                        localStorage.setItem('local_cart', JSON.stringify(localCart));
                        {% endif %}
                    } else {
                        showToast(response.message, 'error');
                    }
                },
                complete: function() {
                    $(`.add-to-cart-${productId}`).prop('disabled', false).html('<i class="fas fa-shopping-cart"></i>');
                }
            });
        }

        // Toast
        function showToast(message, type = 'info') {
            const toastClass = type === 'success' ? 'bg-success' : type === 'error' ? 'bg-danger' : 'bg-info';
            const toastHtml = `
                <div class="toast align-items-center text-white ${toastClass} border-0" role="alert">
                    <div class="d-flex">
                        <div class="toast-body">${message}</div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                    </div>
                </div>`;
            if (!$('#toast-container').length) {
                $('body').append('<div id="toast-container" class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;"></div>');
            }
            const $toast = $(toastHtml);
            $('#toast-container').append($toast);
            const toast = new bootstrap.Toast($toast[0]);
            toast.show();
            setTimeout(() => $toast.remove(), 5000);
        }

        // Initialize tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // Sync localStorage data to server after login
        function syncLocalStorageData() {
            // Check if user is authenticated and we have localStorage data
            const localCart = localStorage.getItem('local_cart');
            const localFavorites = localStorage.getItem('local_favorites');

            if (localCart && localCart !== '{}') {
                try {
                    const cartData = JSON.parse(localCart);
                    $.ajax({
                        url: '{% url "ajax_sync_cart" %}',
                        type: 'POST',
                        data: {
                            'cart': JSON.stringify(cartData),
                            'csrfmiddlewaretoken': csrftoken
                        },
                        success: function(response) {
                            if (response.success) {
                                updateCartCount(response.cart_total);
                                localStorage.removeItem('local_cart');
                                console.log('Local cart synced successfully');
                            }
                        },
                        error: function() {
                            console.log('Failed to sync local cart');
                        }
                    });
                } catch (e) {
                    console.log('Error parsing local cart data');
                }
            }

            if (localFavorites && localFavorites !== '[]') {
                try {
                    const favoritesData = JSON.parse(localFavorites);
                    $.ajax({
                        url: '{% url "ajax_sync_favorites" %}',
                        type: 'POST',
                        data: {
                            'favorites': JSON.stringify(favoritesData),
                            'csrfmiddlewaretoken': csrftoken
                        },
                        success: function(response) {
                            if (response.success) {
                                updateFavoritesCount(response.favorites_count);
                                localStorage.removeItem('local_favorites');
                                console.log('Local favorites synced successfully');
                            }
                        },
                        error: function() {
                            console.log('Failed to sync local favorites');
                        }
                    });
                } catch (e) {
                    console.log('Error parsing local favorites data');
                }
            }
        }

        // Initialize localStorage data for guest users
        function initializeLocalStorageData() {
            {% if not user.is_authenticated %}
            // Initialize cart count from localStorage
            const localCart = JSON.parse(localStorage.getItem('local_cart') || '{}');
            const cartCount = Object.values(localCart).reduce((sum, quantity) => sum + quantity, 0);
            if (cartCount > 0) {
                updateCartCount(cartCount);
            }

            // Initialize favorites count from localStorage
            const localFavorites = JSON.parse(localStorage.getItem('local_favorites') || '[]');
            if (localFavorites.length > 0) {
                updateFavoritesCount(localFavorites.length);
            }
            {% endif %}
        }

        // Fade-in and handle post-login data
        $(document).ready(function() {
            $('.card').addClass('fade-in');

            // Initialize localStorage data for guest users
            initializeLocalStorageData();

            // Handle saved cart and favorites from login response
            const savedCart = localStorage.getItem('saved_cart_total');
            const savedFavorites = localStorage.getItem('saved_favorites_count');
            if (savedCart) {
                updateCartCount(parseInt(savedCart));
                localStorage.removeItem('saved_cart_total');
            }
            if (savedFavorites) {
                updateFavoritesCount(parseInt(savedFavorites));
                localStorage.removeItem('saved_favorites_count');
            }

            // Sync any remaining localStorage data to server
            {% if user.is_authenticated %}
            syncLocalStorageData();
            {% endif %}
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>